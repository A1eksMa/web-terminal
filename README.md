# Прототип Веб-Терминала для Docker

Этот проект представляет собой простой, но полнофункциональный прототип веб-терминала, который предоставляет доступ к командной строке (`bash`) внутри Docker-контейнера прямо из браузера.

## Архитектура

Система состоит из нескольких ключевых компонентов, которые взаимодействуют друг с другом в режиме реального времени для создания бесшовного опыта работы с терминалом.

```
+-----------------+      +----------------------+      +-----------------+      +------------------+
|                 |      |                      |      |                 |      |                  |
|  Браузер        |<---->|  Python Backend      |<---->|  Docker Daemon  |<---->|  Docker Контейнер|
|  (xterm.js)     |      |  (Flask + Gevent)    |      |  (dockerd)      |      |  (bash)          |
|                 |      |                      |      |                 |      |                  |
+-----------------+      +----------------------+      +-----------------+      +------------------+
       ^                         ^                             ^                        ^
       | WebSocket (ws://)       | Python-библиотека           | Docker API             | Стандартные
       |                         | 'docker'                    | (HTTP/Unix сокет)      | потоки (I/O)
       |                         |                             |                        |
       +-------------------------+-----------------------------+------------------------+
```

**Поток данных (ввод пользователя):**
1.  Пользователь нажимает клавишу в браузере.
2.  `xterm.js` преобразует нажатие в последовательность символов.
3.  JavaScript отправляет эти данные через WebSocket на Python-бэкенд.
4.  Бэкенд получает данные и пересылает их в `stdin` (стандартный поток ввода) процесса `bash`, запущенного внутри контейнера.

**Поток данных (вывод из контейнера):**
1.  Процесс `bash` выполняет команду и ��ыводит результат в `stdout`/`stderr` (стандартные потоки вывода).
2.  Бэкенд считывает эти данные из потоков контейнера.
3.  Данные отправляются обратно клиенту (браузеру) через WebSocket.
4.  `xterm.js` получает данные и отрисовывает их на экране, создавая иллюзию работы в настоящем терминале.

---

## Структура проекта

-   `app.py`: Основной файл приложения. Содержит логику веб-сервера на Flask, обработку WebSocket-соединений и взаимодействие с Docker.
-   `Dockerfile`: Инструкция для сборки Docker-образа, который будет служить средой для нашего терминала. В нем установлены базовые утилиты.
-   `requirements.txt`: Список Python-зависимостей, необходимых для работы бэкенда.
-   `templates/index.html`: HTML-страница, которая содержит фронтенд-часть приложения. Включает в себя библиотеку `xterm.js` и JavaScript-код для устано��ки WebSocket-соединения.
-   `venv/`: (Опционально) Папка с виртуальным окружением Python для изоляции зависимостей.

---

## Зависимости и Технологии

### Backend
-   **Python 3**: Язык программирования для бэкенда.
-   **Flask**: Микро-фреймворк для создания веб-сервера и обработки HTTP-запросов.
-   **Gevent**: Асинхронная библиотека, используемая для запуска высокопроизводительного WSGI-сервера, способного обрабатывать множество одновременных WebSocket-соединений.
-   **flask-sock**: Расширение для Flask, которое упрощает работу с WebSocket, интегрируясь с `gevent`.
-   **docker**: Официальная Python-библиотека для взаимодействия с Docker Daemon API (запуск контейнеров, выполнение команд и т.д.).

### Frontend
-   **xterm.js**: Мощная JavaScript-библиотека, которая эмулирует полнофункциональный терминал в элементе `<canvas>` HTML.
-   **xterm-addon-fit**: Дополнение для `xterm.js`, которое позволяет терминалу автоматически подстраиваться под размер окна браузера.

### Среда выполнения
-   **Docker**: Система контейнеризации, предоставляющая изолированную среду для выполнения команд.

---

## Установка и Запуск

### Требования
-   **Python 3.8+** и `pip`.
-   **Docker** должен быть установлен, запущен, и у текущего пользователя должны быть права на его использование.

### Пошаговая инструкция

1.  **Создайте файлы проекта**, как это было сделано ранее.

2.  **Создайте виртуальное окружение** для изоляции зависимостей (рекомендуется):
    ```bash
    python3 -m venv venv
    ```

3.  **Активируйте виртуальное окружение**:
    -   На Linux/macOS:
        ```bash
        source venv/bin/activate
        ```
    -   На Windows:
        ```bash
        venv\Scripts\activate
        ```

4.  **Установите зависимости** из файла `requirements.txt`:
    ```bash
    pip install -r requirements.txt
    ```

5.  **Запустите приложение**:
    ```bash
    python app.py
    ```
    При первом запуске скрипт автоматически соберет необходимый Docker-образ `gemini-terminal-box`. При последующих запусках он будет использовать уже существующий образ.

6.  **Откройте браузер** и перейдите по адресу:
    [http://127.0.0.1:8080](http://127.0.0.1:8080)

    Вы должны увидеть полнофункциональный терминал, готовый к работе.

7.  **Для остановки сервера** нажмите `Ctrl+C` в консоли, где был запущен скрипт.
